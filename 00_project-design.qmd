---
title: Covid-19 comorbidity in Mexico
subtitle: Project for the subject Data Acquistion, Analysis and Scientific Methods in Life Sciences.  
author:
   - affiliation: Instituto Agroforestal Mediterráneo. Departamento de Ecosistemas Agroforestales. Universidad Politécnica de Valencia.
     affiliation-url: https://www.upv.es/entidades/DEAF/
     email: algarsal@upv.es
     name: Alfonso Garmendia
     orcid: 0000-0001-6837-1818
     url: https://garmendia.blogs.upv.es/
title-block-banner: true
date: last-modified
date-format: iso
lang: en-US
code-fold: true
code_folding: hide 
toc: true
toc-depth: 6
toc-location: body
format:
  html:
    self_contained: TRUE
    embed-resources: true
---

# Teacher comments

## Group A

Members:  Cléa Meystre, Neil Mabalot, Sebastian Torres, Raymundo Gutierrez, Hamna Tahir

Github user names: Cmeystre, neilmabalot-34404, torressebastian757-blip, raymoran-netizen, hannatahirskg09-design

Link to data: https://gaia.inegi.org.mx/covid19/

## The project design

The project is right.  It is interesting to link Covid with social or health data. 

But in the link you provide, there are only covid data. I didn’t find the other health data. 

There are covid19 data also in R packages, as the “COVID19” package from John Hopkins University, which enables also to download data from the World Bank and other sources. You should also explore these. 

Other problem is that you will not have a nice article to follow. It might be interesting to look for an article for the proposed comorbidities. 

For example Salinas-Aguirre et al. (2021) Clinical characteristics and comorbidities associated with mortality in patients with Covid-19 in Coalhuila (Mexico). 

You can start with your project (check the task "Your project. Preliminary results" in PoliformaT). 

# Students proposal

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

1.  Title of your project (in Yaml header)

2.  Names of group members (in Yaml header).

3.  Github user name for each group member.

    Githib user name: Cmeystre, neilmabalot-34404, torressebastian757-blip, raymoran-netizen, hannatahirskg09-design

4.  A description of the selected data. A link to the data and describe its structure and main variables. (If it is your own data, upload it to github to link it here).

    Description: This dataset was created as a report of the COVID-19 pandemic in Mexico. Starting in March 2020 to September 2023. The virus infected and in some cases killed people all over the country. However we theorize that those deaths were affected through other comorbidities present before the infection. We propose to find a corelation between comorbidities such as diabetes, hypertension, smoking and heart diseases and death rates caused by COVID19. The proposal analyzes will be carried out with a lineal regression model.

5.  Define the objectives, research questions and main hypotheses.

    Objective: Determine if the COVID-19 mortality rates are directly linked to contracting the COVID-19 virus or if they are due to the individual being simultaneously infected with COVID-19 and a comorbidity disease(s).

    Research question: What is the correlation between the presence of comorbidities and the mortality rate of COVID-19 patients?

    Main Hypothesis: There is a higher risk of death with a combination of COVID-19 and a comorbidity disease(s).

6.  Name the analyses you think are necessary or which you would like to use.

    1.Linear regression model - To see the correlation between our different factors (Mortality rates, contraction of COVID-19 virus and the presence of comorbidities diseases).

    2.Test for Moderation - To see how the comorbidities impacts COVID-19 deaths.

    3\. ANOVA - To see if there is a statistical difference between mean deaths per age group.

    4.Post-hoc tests ANOVA (Tukey test) - Used to see the statistical differences and attempt to explain their correlation to mortality rates.
    
    Data Link: https://gaia.inegi.org.mx/covid19/
    
#Date: November 20, 2025

#Installed COVID 19 Data in R Packages
```{r}
install.packages("covid19.analytics")
library(covid19.analytics)
data <- covid19.data("ts-confirmed")
head(data)
covid19.data("ts-deaths")
covid19.data("ts-recovered")
covid19.data("ts-ALL")     # all time-series
```

#Our own group data literature search
```{r}
data <- "https://github.com/algarsal/2025Agroup-covid19/blob/main/covid_mexico_comorbidity_dataset_100k.csv"
covid19W <- read.table(data, header = T, sep = ",")

```

covid19A <- read.csv("/Users/neilsfolder/Documents/MS - EMPH/M1 - First Semester/34404 - Data Acquisition in Life Sciences/Final Project/Literature Search/covid_mexico_comorbidity_dataset_100k.csv")
str (covid19A) 



#Preliminaries
```{r}
summary(covid19A)
library(dplyr)
```


#Create Table: COVID 19 Deaths Without Commorbidity
```{r}
table_no_commorb <- covid19A %>%
  filter(COVID_Death == 1,
         Number_of_Comorbidities == 0)

table_no_commorb

table_no_comorb_summary <- table_no_commorb %>%
  summarise(
    total_cases = n(),
    avg_age = mean(Age),
    gender_counts = list(table(Gender))
  )

table_no_comorb_summary

```
```{r}
table(covid19A$COVID_Death)
table(covid19A$COVID_Death, covid19A$Number_of_Comorbidities)




```



#Create Table: COVID 19 Deaths with Commorbidity
```{r}
table_with_comorb <- covid19A %>%
  filter(COVID_Death == 1,
         Number_of_Comorbidities > 0)

table_with_comorb

table_with_comorb_summary <- table_with_comorb %>%
  summarise(
    total_cases = n(),
    avg_age = mean(Age),
    gender_counts = list(table(Gender)),
    comorb_distribution = list(table(Number_of_Comorbidities))
  )

table_with_comorb_summary
```

7. Introduction. Why your project is interesting? and What is known already about it? Most citations should be done in the introduction.

8. Objectives and hypotheses.

9. Methods. Explain the origin and structure of your data. What have you done? And what did you use to do it? Step by step, so anyone could do it again by reading this part.

10. Results. Figures and tables with captions and description of what do they mean. Never include citations in this part. This is only your work.

#Analyses
#Linear Regression
```{r}
#No Commorbidity - Age + Gender
lm_no_comorb <- lm(COVID_Death ~ Age + Gender, data = table_no_commorb)
summary(lm_no_comorb)

#With Commorbidity - Age + Gender
lm_with_comorb <- lm(COVID_Death ~ Age + Gender + Number_of_Comorbidities, data = table_with_comorb)
summary(lm_with_comorb)

#No Commorbidity - 
lm_no_comorb <- lm(COVID_Death ~ Diabetes + Hypertension + Obesity + Smoking,data = table_no_commorb)
summary(lm_no_comorb)

#With Commorbidity -
lm_with_comorb <- lm(COVID_Death ~ Diabetes + Hypertension + Obesity + Smoking + Number_of_Comorbidities,data = table_with_comorb)

summary(lm_with_comorb)


#------------------------------BETTER------------------------------------------------------

#Table - Diabetes
diabetes_table <- table(covid19A$COVID_Death, covid19A$Diabetes)
diabetes_table <- as.data.frame.matrix(diabetes_table)
diabetes_table

#Chi-square of Diabetes
chisq.test(diabetes_table)
#p-value = p-value < 2.2e-16

#------------------------------BETTER------------------------------------------------------

#Table - Hypertension
hypertension_table <- table(covid19A$COVID_Death, covid19A$Hypertension)
hypertension_table <- as.data.frame.matrix(hypertension_table)
hypertension_table

#Chi-square of Hypertension
chisq.test(hypertension_table)
#p-value = p-value < 2.2e-16

#------------------------------BETTER------------------------------------------------------

#Table - Obesity
obesity_table <- table(covid19A$COVID_Death, covid19A$Obesity)
obesity_table <- as.data.frame.matrix(obesity_table)
obesity_table

#Chi-square of Obesity
chisq.test(obesity_table)
#p-value = p-value < 2.2e-16

#------------------------------BETTER------------------------------------------------------

#Table - Smoking
smoking_table <- table(covid19A$COVID_Death, covid19A$Smoking)
smoking_table <- as.data.frame.matrix(obesity_table)
smoking_table

#Chi-square of Obesity
chisq.test(smoking_table)
#p-value = p-value < 2.2e-16

```

##Logistic Regression

```{r}
#Logistic No Commorbidity
no_comorb <- subset(covid19A, Number_of_Comorbidities == 0)

#Logistic With Commorbidities
with_comorb <- subset(covid19A, Number_of_Comorbidities > 0)

#Logistic Regression - No Commorbidity
logit_no <- glm(COVID_Death ~ 1,        
                data = no_comorb,
                family = binomial)

summary(logit_no)

#Logistic Regression - With Commorbidities
logit_with <- glm(COVID_Death ~ Diabetes + Hypertension + Obesity + Smoking,
                  data = with_comorb,
                  family = binomial)

summary(logit_with)

#Logistic Regression - No. of Commorbidities
logit_noc <- glm(COVID_Death ~ Number_of_Comorbidities,
                  data = with_comorb,
                  family = binomial)

summary(logit_noc)

#Interpretation of Logistic Regression
exp(coef(logit_with))



#Moderation Full
logit_moderation_full <- glm(COVID_Death ~ 
                                Diabetes + Hypertension + Obesity + Smoking +
                                Number_of_Comorbidities +
                                (Number_of_Comorbidities * Smoking),
                              data = covid19A,
                              family = binomial)

summary(logit_moderation_full)



```


11. Discussion. From your objectives.

12. Conclusions.



