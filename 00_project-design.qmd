---
title: Covid-19 comorbidity in Mexico
subtitle: Project for the subject Data Acquistion, Analysis and Scientific Methods in Life Sciences.  
author: 
   - affiliation: Instituto Agroforestal Mediterráneo. Departamento de Ecosistemas Agroforestales. Universidad Politécnica de Valencia.
     affiliation-url: https://www.upv.es/entidades/DEAF/
     email: algarsal@upv.es
     name: Alfonso Garmendia
     orcid: 0000-0001-6837-1818
     url: https://garmendia.blogs.upv.es/
title-block-banner: true
date: last-modified
date-format: iso
lang: en-US
code-fold: true
code_folding: hide 
toc: true
toc-depth: 6
toc-location: body
format:
  html:
    self_contained: TRUE
    embed-resources: true
editor: 
  markdown: 
    wrap: sentence
---

# Teacher comments

## Group A

Members: Cléa Meystre, Neil Mabalot, Raymundo Morán

Github user names: Cmey1338, neilmabalot-34404, raymoran-netizen

Link to data: https://gaia.inegi.org.mx/covid19/

## The project design

The project is right.
It is interesting to link Covid with social or health data.

But in the link you provide, there are only covid data.
I didn’t find the other health data.

There are covid19 data also in R packages, as the “COVID19” package from John Hopkins University, which enables also to download data from the World Bank and other sources.
You should also explore these.

Other problem is that you will not have a nice article to follow.
It might be interesting to look for an article for the proposed comorbidities.

For example Salinas-Aguirre et al. (2021) Clinical characteristics and comorbidities associated with mortality in patients with Covid-19 in Coalhuila (Mexico).

You can start with your project (check the task "Your project. Preliminary results" in PoliformaT).

# Students proposal

Quarto enables you to weave together content and executable code into a finished document.
To learn more about Quarto see <https://quarto.org>.

1.  Title of your project (in Yaml header)

2.  Names of group members (in Yaml header).

3.  Github user name for each group member.
    Githib user name: Cmey1338, neilmabalot-34404, raymoran-netizen

#4.
A description of the selected data.
A link to the data and describe its structure and main variables.
(If it is your own data, upload it to github to link it here).
Description: This dataset was created as a report of the COVID-19 pandemic in Mexico.
Starting in March 2020 to September 2023.
The virus infected and in some cases killed people all over the country.
However we theorize that those deaths were affected through other comorbidities present before the infection.
We propose to find a corelation between comorbidities such as diabetes, hypertension, smoking and heart diseases and death rates caused by COVID19.
The proposal analyzes will be carried out with a lineal regression model.

#5.
Define the objectives, research questions and main hypotheses.
Objective: Determine if the COVID-19 mortality rates are directly linked to contracting the COVID-19 virus or if they are due to the individual being simultaneously infected with COVID-19 and a comorbidity disease(s).

Research question: What is the correlation between the presence of comorbidities and the mortality rate of COVID-19 patients?

Main Hypothesis: There is a higher risk of death with a combination of COVID-19 and a comorbidity disease(s).

#6.
Name the analyses you think are necessary or which you would like to use.
1.Linear regression model - To see the correlation between our different factors (Mortality rates, contraction of COVID-19 virus and the presence of comorbidities diseases).

2.Test for Moderation - To see how the comorbidities impacts COVID-19 deaths.

3.  ANOVA - To see if there is a statistical difference between mean deaths per age group.

4.Post-hoc tests ANOVA (Tukey test) - Used to see the statistical differences and attempt to explain their correlation to mortality rates.

Data Link: https://gaia.inegi.org.mx/covid19/

Sources: https://journals.plos.org/plosone/article?i
d=10.1371/journal.pone.0296895 https://www.sciencedirect.com/science/article/pii/S0014256521000138 https://pmc.ncbi.nlm.nih.gov/articles/PMC7310609/ https://pubmed.ncbi.nlm.nih.gov/33608563/

#7.
Introduction Why your project is interesting?
and What is known already about it?
Most citations should be done in the introduction.

Experiencing a global pandemic in the 21st century is scientifically and statistically jarring, particularly given the era’s sophisticated pharmaceutical and surveillance capabilities.
The emergence of a highly contagious respiratory illness in 2020 infamously known as the Coronavirus Disease 2019 (COVID-19), caused by the virus ‘Severe Acute Respiratory Syndrome Coronavirus 2’ (SARs-CoV-2), has profoundly impacted global health that resulted in a declaration of global health emergency.
As a result, this prompted extensive research into the factors that contribute to severe outcomes and mortality.
Understanding the pathophysiological mechanism of viral disease infections, the role of comorbidities, i.e., pre-existing health conditions, became the main research interest linking its influence on the risk of death among individuals infected with SARS-CoV-2.
Over the years since the pandemic passed, multiple literature quantified the mortality risk associated with comorbidities.
One study by Elezkurtaj et al. (2021) highlighted that COVID-19 patients with more than two comorbidities increased mortality than those with single or no comorbidities.
Among the comorbidities identified, a study by Espinosa et al. (2021) revealed that hypertension, diabetes, and cardiovascular disease were the most frequent comorbidities in fatal cases of COVID-19.
Furthermore, another study by Salinas-Aguirre et al. (2022) concluded that diabetes mellitus, systemic arterial hypertension, obesity, and chronic kidney damage increase mortality in patients with COVID-19 in the population of Coahuila in Mexico.
These findings were further solidified by a study conducted by Lowhorn et al. (2024) stating that hypertension, followed by obesity and diabetes, are the most often occurring comorbidities in COVID-19 patients and are also some of the comorbidities most strongly related with high mortality rates in the Mexican population.
Considering the literatures cited, the impact of the COVID-19 pandemic in Mexico is arguably one of the most severe in the world.
The pandemic in Mexico wasn't just a viral outbreak; it was a synergistic epidemic where the virus collided with the country's high rates of pre-existing chronic disease crisis (comorbidities).
In line with this, our project aims to statistically analyze the data presented in the Analytical Viewer for COVID-19, a platform created by Mexico's National Institute of Statistics and Geography (INEGI).
By exploring this link, our project aims to delve deeper into the nuances of comorbidity-related risks and its implications on actionable insights and protective measures for future pandemic preparedness, especially to the vulnerable sector of the population.

#8.
Objectives and hypotheses Objective: The current project aims to substantiate the association between the mortality and the pre-existing health conditions / comorbidities of COVID-19 patients from Mexico City using the INEGI dataset, thereby providing a comparative analysis against literature-based evidence from some parts of Mexico and national studies to validate the consistency of comorbidity impact across different Mexican demographics.
3 Hypotheses: 1.
COVID-19 patients with pre-existing health condition / comorbidity are more likely to die from the viral disease.
2.
Among the 4 identified comorbidities, COVID-19 patients with cardiovascular diseases are more likely to die from the viral disease.\
3.
Ultimately, COVID-19 patients with cardiovascular disease in combination of another comorbidity are more likely to die from the viral disease.

#9.
Methods Explain the origin and structure of your data.
What have you done?
And what did you use to do it?
Step by step, so anyone could do it again by reading this part.
1.
Chi square Test - The Chi square test is gonna allow us to find statistical association between DEATHS & each COMORBIDITY.
All tests resulted in highly significant p-values, indicating that the distribution of deaths differs significantly between patients with and without the comorbidity.
So the death rate for those with any comorbidities is not likely to be random.
This supports the conclusion that comorbidities are strongly associated with increased mortality.
Once statistically significant values are found.
An anylsis to see association between each and every comorbidity would be ideal, to investigate about the probability of death based on the presence or absence of each comorbidity, combinations & interactions.
The logistic model is ideal for this analysis because our outcome variables are binary.

2.  Logistic Regressions (LRM)- We first ran individual LRM to measure the association of each individual Comorbidity.
    Then to isolate the effect we incorporated all the Comorbidities analyzed in this study as a Multivariable Model (MVM).
    This model is considering the whole dataset.
    Answering the question: Across the entire population, does each comorbidity increase the odds of dying?
    We then made another version of the MVM that would only consider the people with at least 1 comorbility (a subset of the data (Number of CM \>=1)) that would attenuate the effect of the Comorbitiy (MVMwithCM).
    Answering the question: Among people who already have comorbidities, which specific diseases increase the odds of death?
    We then compared the MVM and the MVMwithCM models with a mortality baseline given by a LRM of only the people WITH OUT any CM (LRMnoCM).
    Another interesting question to analyse would be if the addition of multiple Comorbities increases the odds of death.To answer this question we ran a LRM considering Number_of_Comorbidities (given in our dataset) (LRM_NCM).
    This confirmed that the risk of death increases as the Number_of_Comorbidities increases.
    Identifying which combination of Comorbidities is the most dangerous would help us shape the profile for a high risk of death infected person, given that usually Comorbidities appear simultaneously.
    To analyse this we used the Paired LRM (PLRM) and used it to compare Diabetes + Hypertension, Diabetes + Smoking, Diabetes + Obesity, Hypertension + Smoking, Obesity + Smoking and Hypertension + Obesity.
    Finally, we created a single combined output table with the Individual LRM results for each Comorbidity and the PLRM results.

3.  AIC and BIC analyses - The purpose of AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion) is to help select the best statistical model from a set of candidates by balancing model fit (how well it explains the data) with model complexity (number of parameters).
    The model with the lowest AIC or BIC value is generally preferred.
    AIC favors predictive accuracy, while BIC leans towards simpler, more parsimonious models, especially with large datasets, aiming closer to the "true" underlying model.
    In our code we found that out of all Single-Predictor Models, Obesity has the lowest AIC and lowest BIC.
    This means that it is the strongest single predictor of COVID death (statistically, based on these models).
    Hypertension is very close, meaning it is also a strong predictor.
    Smoking has the worst AIC/BIC, meaning it is the weakest single predictor.
    Then when interpreting Interpretation of Paired-Predictor Models the pair Diabetes + Smoking had the lowest AIC and BIC values, meaning that they are the best predicts COVID death and is consequently the strongest.
    The AIC/BIC values help identify which combinations add the most predictive value.

4.  AIV and GIV analyses - Incremental value analysis was used to quantify the relative importance of four predictors—hypertension, obesity, diabetes, and smoking—across multiple logistic regression specifications.
    Average Incremental Value (AIV) was computed for each predictor as the mean absolute standardized coefficient (\|β/SE\|) across all models in which the predictor appeared.
    AIV reflects the average individual contribution of a predictor to model performance, regardless of other covariates.
    General Incremental Value (GIV) was calculated as the sum of AIV contributions across all model combinations involving each predictor.
    GIV reflects the overall importance of each variable across the entire model space, capturing how consistently and strongly it improves predictive performance.
    Both metrics provide a complementary assessment: AIV reflects effect strength within models, while GIV reflects global contribution across models.
    Higher values for either metric indicate stronger incremental predictive importance.

5.  ANOVA - The purpose of ANOVA (Analysis of Variance) is to determine if there are statistically significant differences between the means of three or more groups.
    Furthermore it tests if variations in a dependent variable are due to an independent variable or random chance.
    Our ANOVA testing gave us higher LR Chi-square values for Hypertension and Diabetes.
    This confirms that they are both highly significant independent predictors of COVID-19 death.
    All predictors (Diabetes, Hypertension, Smoking, Obesity) have p-values \< 2.2e-16, meaning extremely strong evidence that each predictor is associated with COVID-19 mortality, independently of the other variable in the model.
    Strength of predictors, based on the LR Chisq value is the strongest for Hypertension, then for Diabetes, then Obesity and lastlt Smoking is slightly less strong than others.

#10 Results Figures and tables with captions and description of what do they mean.Never include citations in this part.
This is only your work.
Figure 1: Figue 2: Figure 3: The AIV quantifies the additional predictive usefulness gained from each predictor when added to the model.
Higher values indicate stronger contribution.
Hypertension shows the highest average incremental value among predictor Figure 4: The GIV reflects the overall added predictive value contributed by each predictor across the full model.
Larger GIV values represent more influential predictors.
Hypertension shows the highest average incremental value among predictor.

#11 Discussion From your objectives.

#12.
Conclusions

# Load the data base
```{r}
dir("data")
data <- "data/covid_mexico_comorbidity_dataset_100k.csv"
covid19A <- read.table(data, header = T, sep = ",")
str (covid19A) 
summary(covid19A)

library(dplyr)
```

# Chi square Test
The Chi square test is gonna allow us to find association between Deaths & each Comorbidities
```{r}
comorbidities <- c("Diabetes", "Hypertension", "Obesity", "Smoking")

for (c in comorbidities) {
  cat("\n==========================\n")
  cat("Chi-square test for", c, "\n")
  tab <- table(covid19A$COVID_Death, covid19A[[c]])
}
```

# Results table
```{r}
chi_results <- data.frame(
  Comorbidity = character(),
  Chi_square = numeric(),
  df = numeric(),
  P_value = numeric()
)

for (c in comorbidities) {
  tab <- table(covid19A$COVID_Death, covid19A[[c]])
  chi <- chisq.test(tab)
  
  chi_results <- rbind(
    chi_results,
    data.frame(
      Comorbidity = c,
      Chi_square = chi$statistic,
      df = chi$parameter,
      P_value = chi$p.value
    )
  )
}
chi_results
```

# LOGISTIC REGRESION MODEL (LRM)
LRM for each Comorbidity Individualy
```{r}
##load library 
library(broom)

#Indiv. LRM Diabetes
model_Diabetes <- glm(
  COVID_Death ~ Diabetes,
  data = covid19A,
  family = binomial()
)

#Indiv. LRM Smoking
model_Smoking <- glm(
  COVID_Death ~ Smoking,
  data = covid19A,
  family = binomial()
)

#Indiv. LRM  Obesity
model_Obesity <- glm(
  COVID_Death ~ Obesity,
  data = covid19A,
  family = binomial()
)

#Indiv. LRM  Hypertension
model_Hypertension <- glm(
  COVID_Death ~ Hypertension,
  data = covid19A,
  family = binomial()
)

#Multivariable Model (MVM)
MVM <- glm(COVID_Death ~ Diabetes + Hypertension + Obesity + Smoking,
                  data = covid19A,
                  family = binomial)
summary(MVM)

#MVM with CM
with_comorb <- subset(covid19A, Number_of_Comorbidities > 0)
MVMwithCM <- glm(COVID_Death ~ Diabetes + Hypertension + Obesity + Smoking,
                  data = with_comorb,
                  family = binomial)
summary(MVMwithCM)

#Mortality baseline (Deaths WITH OUT CM)
no_comorb <- subset(covid19A, Number_of_Comorbidities == 0)
LRMnoCM <- glm(COVID_Death ~ 1,        
                data = no_comorb,
                family = binomial)
summary(LRMnoCM)

#LRM Number of comorbidities
LRM_NCM <- glm(COVID_Death ~ Number_of_Comorbidities,
                 data = with_comorb, #again with the subset 
                 family = binomial)
summary(LRM_NCM)

```

# Paired Logistic Regression Models (PLRM)
```{r}
#Logistic Regression 1: Diabetes + Hypertension 
model_Diabetes_Hypertension <- glm( COVID_Death ~ Diabetes + Hypertension, data = covid19A, family = binomial() )

#Logistic Regression 2: Diabetes + Smoking
model_Diabetes_Smoking <- glm( COVID_Death ~ Diabetes + Smoking, data = covid19A, family = binomial() )

#Logistic Regression 3: Diabetes + Obesity
model_Diabetes_Obesity <- glm( COVID_Death ~ Diabetes + Obesity, data = covid19A, family = binomial() )

#Logistic Regression 4: Hypertension + Smoking
model_Hypertension_Smoking <- glm( COVID_Death ~ Hypertension + Smoking, data = covid19A, family = binomial() )

#Logistic Regression 5: Obesity + Smoking
model_Obesity_Smoking <- glm( COVID_Death ~ Obesity + Smoking, data = covid19A, family = binomial() )

#Logistic Regression 6: Hypertension + Obesity
model_Hypertension_Obesity <- glm( COVID_Death ~ Hypertension + Obesity, data = covid19A, family = binomial() )
```

#Single combined output table
```{r}
library(dplyr)

models <- list(
  Diabetes_Hypertension = model_Diabetes_Hypertension,
  Diabetes_Smoking = model_Diabetes_Smoking,
  Diabetes_Obesity = model_Diabetes_Obesity,
  Hypertension_Smoking = model_Hypertension_Smoking,
  Obesity_Smoking = model_Obesity_Smoking,
  Hypertension_Obesity = model_Hypertension_Obesity,
  Hypertension = model_Hypertension,
  Obesity = model_Obesity,
  Smoking = model_Smoking,
  Diabetes = model_Diabetes
)

results <- lapply(names(models), function(name) {
  tidy(models[[name]], exponentiate = TRUE, conf.int = TRUE) %>%
    mutate(Model = name)
})
combined_results <- bind_rows(results)
combined_results

#Single models for Individual CM
models2 <- list(
  Hypertension = model_Hypertension,
  Obesity = model_Obesity,
  Smoking = model_Smoking,
  Diabetes = model_Diabetes
)

results2 <- lapply(names(models2), function(name) {
  tidy(models2[[name]], exponentiate = TRUE, conf.int = TRUE) %>%
    mutate(Model = name)
})
combined_results2 <- bind_rows(results2)
combined_results2

#Tables of combined results
library(knitr)

combined_results_clean <- combined_results %>%
  filter(term != "(Intercept)") %>%
  select(-contains("stat", ignore.case = TRUE)) %>%
  as.data.frame()

names(combined_results_clean)
#kable(combined_results_clean, digits = 3, caption = "Paired Logistic Regression Results")

combined_results2_clean <- combined_results2 %>%
  filter(term != "(Intercept)") %>%
  select(-contains("stat", ignore.case = TRUE)) %>%
  as.data.frame()

names(combined_results2_clean)
#kable(combined_results2_clean, digits = 3, caption = "Single-Predictor Logistic Regression Results")

knitr::kable(combined_results_clean, caption = "Paired Logistic Regression Results", digits = 2, align = "c")
knitr::kable(combined_results2_clean, caption = "Single-Predictor Logistic Regression Results", digits = 2, align = "c")
```

# AIC and BIC Analyses
```{r}
models_paired <- list(
  Diabetes_Hypertension = model_Diabetes_Hypertension,
  Diabetes_Smoking      = model_Diabetes_Smoking,
  Diabetes_Obesity      = model_Diabetes_Obesity,
  Hypertension_Smoking  = model_Hypertension_Smoking,
  Obesity_Smoking       = model_Obesity_Smoking,
  Hypertension_Obesity  = model_Hypertension_Obesity
)

info_criteria_paired <- lapply(names(models_paired), function(name) {
  m <- models_paired[[name]]
  
  data.frame(
    Model = name,
    AIC  = AIC(m),
    BIC  = BIC(m)
  )
})

AIC_BIC_table_paired <- dplyr::bind_rows(info_criteria_paired)
#AIC_BIC_table_paired

models2 <- list(
  Hypertension = model_Hypertension,
  Obesity = model_Obesity,
  Smoking = model_Smoking,
  Diabetes = model_Diabetes
)

info_criteria2 <- lapply(names(models2), function(name) {
  m <- models2[[name]]
  
  data.frame(
    Model = name,
    AIC  = AIC(m),
    BIC  = BIC(m)
  )
})

AIC_BIC_table2 <- dplyr::bind_rows(info_criteria2)
#AIC_BIC_table2

knitr::kable(AIC_BIC_table2, caption = "AIC and BIC for Single-Predictor Models", digits = 2, align = "c")
knitr::kable(AIC_BIC_table_paired, caption = "AIC and BIC for Paired Models", digits = 2, align = "c")
```

#Graph Heatmap to show represent combined result table
```{r}
library(ggplot2)

ls(combined_results)
head(combined_results)
combined_results %>%
  filter(term != "(Intercept)") %>%
  ggplot(aes(x = Model, y = term, fill = -log10(p.value))) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "red") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Comorbidities Risk Factor Heatmap",
    x = "Model",
    y = "Risk Factor",
    fill = "-log10(p)"
  )

#Adding legend and caption to the Heatmap graph
caption_text <- "Figure 1: Statistical significance of risk factors. Darker red = higher significance level (-log10 p-value)." 

combined_results %>%
  filter(term != "(Intercept)") %>%
  ggplot(aes(x = Model, y = term, fill = -log10(p.value))) +
  geom_tile(color = "grey70") +
  scale_fill_gradient(low = "white", high = "red", name = "-log10(p)") +
  theme_bw() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold"),
    plot.caption = element_text(hjust = 0.5)  
  ) +
  labs(
    title = "Comorbidities Risk Factor Heatmap",
    x = "Model",
    y = "Risk Factor",
    caption = strwrap(caption_text, width = 110)
  )

#Heatmap for Individual CM
ls(combined_results2)
head(combined_results2)
combined_results2 %>%
  filter(term != "(Intercept)") %>%
  ggplot(aes(x = Model, y = term, fill = -log10(p.value))) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "red") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Individual Comorbidities Risk Factor Heatmap",
    x = "Model",
    y = "Risk Factor",
    fill = "-log10(p)"
  )

#Adding legend and caption to the Heatmap graph
caption_text <- "Figure 2: Statistical significance of risk factors. Darker red = higher significance level (-log10 p-value)." 

combined_results2 %>%
  filter(term != "(Intercept)") %>%
  ggplot(aes(x = Model, y = term, fill = -log10(p.value))) +
  geom_tile(color = "grey70") +
  scale_fill_gradient(low = "white", high = "red", name = "-log10(p)") +
  theme_bw() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(face = "bold"),
    plot.caption = element_text(hjust = 0.5)  
  ) +
  labs(
    title = "Individual Comorbidities Risk Factor Heatmap",
    x = "Model",
    y = "Risk Factor",
    caption = strwrap(caption_text, width = 110)
  )

```

# AIV and GIV Analyses
```{r}
# Extract variables from model name
if (is.list(results) && !is.data.frame(results)) {
  results <- bind_rows(results)
}
model_vars <- results %>%
  distinct(Model) %>%
  mutate(vars = strsplit(Model, "_"))

aiv <- results %>%
  filter(term != "(Intercept)") %>%
  mutate(standardized = abs(estimate / std.error)) %>%
  group_by(term) %>%
  summarise(AIV = mean(standardized)) %>%
  arrange(desc(AIV))

# Expand model × variable pairs
library(tidyr)
model_var_pairs <- model_vars %>%
  unnest(vars)%>%
  rename(term = vars)

giv <- model_var_pairs %>%
  left_join(aiv, by = "term") %>%
  group_by(term) %>%
  summarise(GIV = sum(AIV)) %>%
  arrange(desc(GIV))

#AIV bar chart
library(ggplot2)
ggplot(aiv, aes(x = reorder(term, AIV), y = AIV)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Average Incremental Value (AIV) by Predictor",
    x = "Predictor",
    y = "AIV"
  ) +
  theme_minimal(base_size = 10)

#GIV bar chart 
ggplot(giv, aes(x = reorder(term, GIV), y = GIV)) +
  geom_col(fill = "darkorange") +
  coord_flip() +
  labs(
    title = "General Incremental Value (GIV) by Predictor",
    x = "Predictor",
    y = "GIV"
  ) +
  theme_minimal(base_size = 10)

#Adding legend and caption to the AIV and GIV graph
library(stringr)

caption_text <- "Figure 3: The AIV of the 4 comorbidities are ordered from highest to lowest contribution to COVID-19 mortality."

ggplot(aiv, aes(x = reorder(term, AIV), y = AIV)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Average Incremental Value (AIV) by Predictor",
    x = "Predictor",
    y = "AIV",
    caption = str_wrap(caption_text, width = 70)   # <— caption added + wrapped
  ) +
  theme_minimal(base_size = 10) +
  theme(
    plot.caption = element_text(
      hjust = 0,                 # left-align caption
      size = 9,
      margin = margin(t = 10)    # spacing above caption
    )
  )

giv_caption <- "Figure 4: The GIV of the 4 comorbidities are ordered from highest to lowest contribution to COVID-19 mortality."

ggplot(giv, aes(x = reorder(term, GIV), y = GIV)) +
  geom_col(fill = "darkorange") +
  coord_flip() +
  labs(
    title = "General Incremental Value (GIV) by Predictor",
    x = "Predictor",
    y = "GIV",
    caption = str_wrap(giv_caption, width = 70)   # wrapped caption
  ) +
  theme_minimal(base_size = 10) +
  theme(
    plot.caption = element_text(
      hjust = 0,                 # left align caption
      size = 9,
      margin = margin(t = 10)    # add space above caption
    )
  )

```

# ANOVA Analyses
